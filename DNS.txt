Подробное объяснение рекурсивных запросов и предупреждения
Что такое рекурсивный DNS-запрос?

Когда DNS-клиент (например, ваш компьютер или смартфон) запрашивает доменное имя, он может сделать это двумя способами:

    Рекурсивный запрос: Клиент ожидает, что DNS-сервер полностью обработает запрос и вернет окончательный ответ. Если сервер не знает ответа, он сам отправит запросы другим DNS-серверам и вернет клиенту окончательный результат. В этом случае клиент делает запрос только один раз, а весь процесс поиска ответа обрабатывается сервером.

    Итеративный запрос: Клиент получает ответ от DNS-сервера на каждом шаге и сам продолжает запрос к другим DNS-серверам. Например, если сервер не знает точного IP-адреса, он может направить клиента к другому серверу, который ближе к ответу.

Почему важна рекурсия?

    Удобство для клиента: Клиенту не нужно отправлять несколько запросов; он получает окончательный ответ от одного сервера.
    Нагрузка на сервер: Рекурсивный сервер берет на себя всю работу по разрешению имени, что может увеличить его нагрузку.

Что означает предупреждение recursion requested but not available?

Предупреждение recursion requested but not available означает, что ваш запрос содержал флаг, указывающий на то, что вы хотите, чтобы сервер выполнил рекурсивный запрос (т.е. разрешил доменное имя полностью сам). Однако сервер ns1.reg.ru ответил, что он не поддерживает или не предоставляет рекурсивные запросы.

Это может происходить по нескольким причинам:

    Конфигурация сервера: Администраторы DNS-сервера могут настроить его так, чтобы он не выполнял рекурсивные запросы для внешних клиентов, чтобы снизить нагрузку или повысить безопасность.
    Тип сервера: Авторитетные DNS-серверы, такие как ns1.reg.ru, часто настроены для обработки только итеративных запросов. Они возвращают информацию только о своих зонах ответственности и не выполняют дальнейшие запросы к другим серверам.
    Безопасность: Ограничение рекурсии может помочь предотвратить различные виды атак, такие как DDoS-атаки через DNS-усиление.

Пример работы рекурсивного и итеративного запросов:

Рекурсивный запрос:

    Клиент отправляет запрос на сервер ns1.reg.ru для домена it-website.ru.
    Сервер ns1.reg.ru не знает IP-адреса, но, будучи рекурсивным сервером, он отправляет запрос к корневому серверу.
    Корневой сервер отвечает ссылкой на сервер зоны .ru.
    Сервер ns1.reg.ru запрашивает сервер зоны .ru.
    Сервер зоны .ru направляет к серверу it-website.ru.
    Сервер ns1.reg.ru получает ответ и возвращает его клиенту.

Итеративный запрос:

    Клиент отправляет запрос на сервер ns1.reg.ru для домена it-website.ru.
    Сервер ns1.reg.ru отвечает: "Я не знаю IP-адреса, но вот сервер зоны .ru."
    Клиент отправляет запрос серверу зоны .ru.
    Сервер зоны .ru отвечает: "Я не знаю IP-адреса, но вот сервер для it-website.ru."
    Клиент отправляет запрос серверу it-website.ru и получает окончательный ответ.

Заключение

Предупреждение recursion requested but not available просто указывает на то, что сервер, к которому вы обратились, настроен только для обработки итеративных запросов. Он не будет выполнять полное разрешение имени за вас, а вместо этого предоставит вам информацию, чтобы вы могли продолжить запрос самостоятельно.

Вот вывод команды dig

root@yuraserver:~# dig @ns1.reg.ru. it-website.ru

; <<>> DiG 9.18.24-0ubuntu0.22.04.1-Ubuntu <<>> @ns1.reg.ru. it-website.ru
; (11 servers found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 65417
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
;; QUESTION SECTION:
;it-website.ru.                 IN      A

;; ANSWER SECTION:
it-website.ru.          86400   IN      A       89.107.10.136

;; Query time: 152 msec
;; SERVER: 194.58.117.17#53(ns1.reg.ru.) (UDP)
;; WHEN: Thu Jul 11 03:46:19 UTC 2024
;; MSG SIZE  rcvd: 58


В системе DNS (Domain Name System) существует 13 основных корневых серверов, обозначаемых латинскими буквами от A до M. Эти корневые серверы управляются различными организациями и распределены по всему миру.

Вот их краткий список:

    A.ROOT-SERVERS.NET
    -
    M.ROOT-SERVERS.NET

Каждый из этих серверов не является одной физической машиной, а представляет собой целую сеть серверов, работающих на разных географических точках. Это делается для повышения надежности и устойчивости к сбоям. Эти сети серверов часто используют технологию anycast, которая позволяет одному IP-адресу принадлежать множеству узлов, обеспечивая балансировку нагрузки и повышенную устойчивость к отказам.

Таким образом, даже если один или несколько корневых серверов выйдут из строя, оставшиеся продолжат обрабатывать запросы, что делает систему DNS крайне устойчивой и надежной.
